<!doctype html>
<html lang="en">
<head>
    <link rel="stylesheet" href="http://dev.camptocamp.com/files/ol3/webgl/build/ol.css" type="text/css">
    <!--<link rel="stylesheet" href="http://openlayers.org/en/v3.0.0/css/ol.css" type="text/css">-->

    <style>
        html { height: 100% }
        body { height: 100%; margin: 0; padding: 0;}
        #map{ height: 100% }
    </style>
    <!--<script src="http://openlayers.org/en/v3.0.0/build/ol.js" type="text/javascript"></script>-->
    <script src="http://dev.camptocamp.com/files/ol3/webgl/build/ol.js" type="text/javascript"></script>
    <title>Pandana WebGL Rendering</title>
</head>
<body>
<div id="map" class="map"></div>
<script type="text/javascript">

    var color = "YlGnBu";
    var scale = "quantile";
    var buckets = 7;

    var defStyle = new ol.style.Style({
        image: new ol.style.Circle({
            radius: 2,
            fill: new ol.style.Fill({color: 'red'})
        })
    });

    var vectorLayer = new ol.layer.Vector({
        source: new ol.source.GeoJSON({
            url: 'analysis_big.geojson'
        }),
        style: defStyle
        /*style: function(feature, resolution) {
            var v = feature.get("values");
            v /= (100/buckets);
            v = Math.min(Math.floor(v), buckets-1);
            return [new ol.style.Style({
                image: new ol.style.Circle({
                    radius: 2,
                    fill: new ol.style.Fill({color: colorbrewer[color][buckets][v]})
                })
            })];
        }*/
    });

    var key = 'Ak-dzM4wZjSqTlzveKz5u0d4IQ4bRzVI309GxmkgSVr1ewS6iPSrOvOKhA-CJlm3';
    var map = new ol.Map({
        layers: [
            new ol.layer.Tile({
                source: new ol.source.BingMaps({
                    key: key,
                    imagerySet: 'Aerial'
                })
            }),
            vectorLayer
        ],
        target: 'map',
        view: new ol.View2D({
        //view: new ol.View({
            center: ol.proj.transform([-122.4191, 37.7792], 'EPSG:4326', 'EPSG:3857'),
            zoom: 12
        })
    });

    var colorbrewer = {YlGn: {
        3: ["#f7fcb9","#addd8e","#31a354"],
        4: ["#ffffcc","#c2e699","#78c679","#238443"],
        5: ["#ffffcc","#c2e699","#78c679","#31a354","#006837"],
        6: ["#ffffcc","#d9f0a3","#addd8e","#78c679","#31a354","#006837"],
        7: ["#ffffcc","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],
        8: ["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],
        9: ["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"]
    },YlGnBu: {
        3: ["#edf8b1","#7fcdbb","#2c7fb8"],
        4: ["#ffffcc","#a1dab4","#41b6c4","#225ea8"],
        5: ["#ffffcc","#a1dab4","#41b6c4","#2c7fb8","#253494"],
        6: ["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#2c7fb8","#253494"],
        7: ["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],
        8: ["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],
        9: ["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"]
    }};

</script>
</body>
</html>