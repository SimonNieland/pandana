<script src="d3.v3.min.js" charset="utf-8"></script>
<script src="pathgl.js"></script>
<canvas height="4800px" width="4800px" style="background-color: black;"></canvas>
<script>
    var buckets = 7;
    var colors = 'YlGn';

    d3.csv("analysis.csv", function(d) {
        return {
            values:  +d.values,
            x:      +d.x,
            y:      +d.y
        };
    }, function(error, rows) {

        value_scale = d3.scale.quantile()
                .domain(d3.extent(rows, function(r) {return r.values}))
                .range(d3.range(buckets));

        x_scale = d3.scale.linear()
                .domain(d3.extent(rows, function(r) {return r.x}))
                .range([0, 4800]);
        y_scale = d3.scale.linear()
                .domain(d3.extent(rows, function(r) {return r.y}))
                .range([4800, 0]);

        rows.forEach(function(r) {
            d3.select('canvas').append('circle')
                    .attr('r', 1)
                    .attr('cx', x_scale(r.x))
                    .attr('cy', y_scale(r.y))
                    .attr('fill', colorbrewer[colors][buckets][value_scale(r.values)])
        });

    });

    var colorbrewer = {YlGn: {
        3: ["#f7fcb9","#addd8e","#31a354"],
        4: ["#ffffcc","#c2e699","#78c679","#238443"],
        5: ["#ffffcc","#c2e699","#78c679","#31a354","#006837"],
        6: ["#ffffcc","#d9f0a3","#addd8e","#78c679","#31a354","#006837"],
        7: ["#ffffcc","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],
        8: ["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],
        9: ["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"]
    },YlGnBu: {
        3: ["#edf8b1","#7fcdbb","#2c7fb8"],
        4: ["#ffffcc","#a1dab4","#41b6c4","#225ea8"],
        5: ["#ffffcc","#a1dab4","#41b6c4","#2c7fb8","#253494"],
        6: ["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#2c7fb8","#253494"],
        7: ["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],
        8: ["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],
        9: ["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"]
    }};

</script>